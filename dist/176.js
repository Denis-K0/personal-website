"use strict";(self.webpackChunkportfolio_page=self.webpackChunkportfolio_page||[]).push([[176],{176:(e,t,n)=>{n.r(t),n.d(t,{coreData:()=>h,gameStatus:()=>p});const i={pawn(e,t,n,i){let l=[];return l.push(...o.getPawnMoves(e,t,n,i)),{possibleMoves:l}},tower(e,t,n,i,l,c){let r=[];return r.push(...o.getTowerMoves(e,t,n,i)),r.push(...o.getRochadMoves(e,t,n,i,l)),{possibleMoves:r}},knight(e,t,n,i){let l=[];return l.push(...o.getKnightMoves(e,t,n,i)),{possibleMoves:l}},bishop(e,t,n,i){let l=[];return l.push(...o.getBishopMoves(e,t,n,i)),{possibleMoves:l}},queen(e,t,n,i){let l=[];return l.push(...o.getTowerMoves(e,t,n,i)),l.push(...o.getBishopMoves(e,t,n,i)),{possibleMoves:l}},king(e,t,n,i){let l=[];return l.push(...o.getKingMoves(e,t,n,i)),{possibleMoves:l}}},o={getPawnMoves(e,t,n,i){const o="White"===i?-1:1,[l,c]=t;let r=[];return l+o<0||l+o>7||c<0||c>7||""===n[l+o][c]&&(r.push([l+o,c]),l+2*o<0||l+2*o>7||c<0||c>7||""===n[l+2*o][c]&&("White"===i&&6===l||"Black"===i&&1===l)&&r.push([l+2*o,c])),l+o>=0&&l+o<=7&&c-1>=0&&c-1<=7&&""!==n[l+o][c-1]&&n[l+o][c-1].includes(e)&&r.push([l+o,c-1]),l+o>=0&&l+o<=7&&c+1>=0&&c+1<=7&&""!==n[l+o][c+1]&&n[l+o][c+1].includes(e)&&r.push([l+o,c+1]),r},getTowerMoves(e,t,n){const[i,o]=t;let l=[];for(let t=i+1;t<8;t++){if(""!==n[t][o]){n[t][o].includes(e)&&l.push([t,o]);break}l.push([t,o])}for(let t=i-1;t>=0;t--){if(""!==n[t][o]){n[t][o].includes(e)&&l.push([t,o]);break}l.push([t,o])}for(let t=o+1;t<8;t++){if(""!==n[i][t]){n[i][t].includes(e)&&l.push([i,t]);break}l.push([i,t])}for(let t=o-1;t>=0;t--){if(""!==n[i][t]){n[i][t].includes(e)&&l.push([i,t]);break}l.push([i,t])}return l},getRochadMoves(e,t,n,i,o){let[l,c]=t,r=[];if(!("tower01Black"===o&&"0,0"===t.toString()||"tower02Black"===o&&"0,7"===t.toString()||"tower01White"===o&&"7,0"===t.toString()||"tower02White"===o&&"7,7"===t.toString())||!("White"===i&&"king01White"===n[7][4]||"Black"===i&&"king01Black"===n[0][4])||h[i].check)return r;if(l="White"===i?7:0,o.includes("01"))for(let e=c+1;e<=4;e++)if(""!==n[l][e]){if(!n[l][e].includes("king")||!n[l][e].includes(i))break;r.push([l,e])}if(o.includes("02"))for(let e=c-1;e>=4;e--)if(""!==n[l][e]){if(!n[l][e].includes("king")||!n[l][e].includes(i))break;r.push([l,e])}return r},getKnightMoves(e,t,n){const[i,o]=t;let l=[];return[[2,1],[2,-1],[1,2],[-1,2],[-2,1],[-2,-1],[1,-2],[-1,-2]].forEach((([t,c])=>{const r=t+i,a=c+o;if(!(r<0||r>7||a<0||a>7))return""===n[r][a]||n[r][a].includes(e)?l.push([r,a]):void 0})),l},getBishopMoves(e,t,n){const[i,o]=t;let l=[];for(let t=i+1,c=o+1;t<8&&c<8;t++,c++){if(""!==n[t][c]){n[t][c].includes(e)&&l.push([t,c]);break}l.push([t,c])}for(let t=i+1,c=o-1;t<8&&c>=0;t++,c--){if(""!==n[t][c]){n[t][c].includes(e)&&l.push([t,c]);break}l.push([t,c])}for(let t=i-1,c=o-1;t>=0&&c>=0;t--,c--){if(""!==n[t][c]){n[t][c].includes(e)&&l.push([t,c]);break}l.push([t,c])}for(let t=i-1,c=o+1;t>=0&&c<8;t--,c++){if(""!==n[t][c]){n[t][c].includes(e)&&l.push([t,c]);break}l.push([t,c])}return l},getKingMoves(e,t,n){const[i,o]=t;let l=[];return[[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1],[0,-1],[1,-1]].forEach((([t,c])=>{const r=t+i,a=c+o;if(!(r<0||r>7||a<0||a>7))return""===n[r][a]||n[r][a].includes(e)?l.push([r,a]):void 0})),l}},l={get popUp(){return document.getElementById("chessPopUp")},changeMsg(e){this.popUp.innerText=e,this.showAndHide()},showAndHide(){this.popUp.classList.contains("show")&&!this.popUp.innerText.includes("Congratulation")||(this.popUp.innerText.includes("Congratulation")?(this.popUp.classList.add("showWin"),setTimeout((function(){l.popUp?.classList?.remove("showWin")}),5050)):(this.popUp.classList.add("show"),setTimeout((function(){l.popUp?.classList?.remove("show")}),1250)))}},c={get htmlBoard(){return document.querySelectorAll(".fieldCluster")},addEventsToBoard(){c.htmlBoard.forEach((e=>{e.addEventListener("click",a.selectPiece),e.addEventListener("keydown",d.handleKeyDownSelectPiece)}))},removeEventsFromBoard(){c.htmlBoard.forEach((e=>{e.removeEventListener("click",a.selectPiece),e.removeEventListener("click",s.executeTurn),e.removeEventListener("click",c.deselect),e.removeEventListener("keydown",d.handleKeyDownSelectPiece),e.removeEventListener("keydown",d.handleKeyDownExecuteTurn),e.removeEventListener("keydown",d.handleKeyDownDeselect),e.classList.remove("highlighted")}))},addExecuteEventsToBoard(){c.htmlBoard.forEach((e=>{const t=+e.id.slice(-2);c.checkCluster(t)?(e.addEventListener("click",s.executeTurn),e.addEventListener("keydown",d.handleKeyDownExecuteTurn),e.classList.add("highlighted")):(e.addEventListener("click",c.deselect),e.addEventListener("keydown",d.handleKeyDownDeselect))}))},checkCluster(e){for(const t of r.availableMoves){const[n,i]=t;if(8*n+i+1===e)return!0}return!1},displayValidMoves(){c.removeEventsFromBoard(),c.addExecuteEventsToBoard()},deselect(){c.removeEventsFromBoard(),c.addEventsToBoard()}},r={pieceId:"",availableMoves:[],get pieceName(){return this.getPieceName(this.pieceId)},get piecePosition(){return this.getPiecePosition(this.pieceId,h.board)},get pieceColor(){return this.pieceId.includes("White")?"White":"Black"},get enemyColor(){return"White"===this.pieceColor?"Black":"White"},getPieceName(e){const t=e.indexOf("0");return e.slice(0,t)},getPiecePosition(e,t){for(let n=0;n<t.length;n++)for(let i=0;i<t[n].length;i++)if(t[n][i]===e)return[n,i];throw new Error("Piece not found on the board! - F:getPiecePosition")}},a={selectPiece(e){const t=e.currentTarget;return r.pieceId=t.children[0]?.id??"No Piece in Cluster",a.checkValidTurn(r.pieceId)?a.calculateValidMoves(r.pieceName)?void c.displayValidMoves():l.changeMsg("No available turns"):l.changeMsg("Choose your piece")},checkValidTurn:e=>!(h.round%2==0||!e.includes("White"))||!(h.round%2!=0||!e.includes("Black")),calculateValidMoves(e){const{possibleMoves:t}=i[e](r.enemyColor,r.piecePosition,h.board,r.pieceColor,r.pieceId);return r.availableMoves=a.filterInvalidMoves(t),0!==r.availableMoves.length},filterInvalidMoves(e){const t=[];for(const n of e){let e=a.simulateMove(n,r.pieceId,r.piecePosition,r.pieceColor);p.isKingInCheck(`king01${r.pieceColor}`,e)||t.push(n)}return t},simulateMove(e,t,n,i){const[o,l]=e,[c,r]=n;let s=JSON.parse(JSON.stringify(h.board));return s[o][l].includes("king01"+i)?(s=a.correctBoardForRochade(s,t),s[c][r]="",s):(s[o][l]=t,s[c][r]="",s)},correctBoardForRochade(e,t){switch(t){case"tower01Black":return e[0][2]="king01Black",e[0][4]="",e[0][3]=t,e;case"tower02Black":return e[0][6]="king01Black",e[0][4]="",e[0][5]=t,e;case"tower01White":return e[7][2]="king01White",e[7][4]="",e[7][3]=t,e;case"tower02White":return e[7][6]="king01White",e[7][4]="",e[7][5]=t,e;default:return console.log("Invalid towerId")}}},s={queenBlack:document.getElementById("queen01Black").cloneNode(!0),queenWhite:document.getElementById("queen01White").cloneNode(!0),executeTurn(e,t){let n=0;n="ai"===e?document.getElementById(t):e.currentTarget;const i=document.getElementById(r.pieceId),o=i.parentElement;s.executeRochadeTurn(n,i,o)||s.executeNormalTurn(n,i,o),s.executePromotion(n,i),c.removeEventsFromBoard(),h.updateBoard()},executeNormalTurn(e,t,n){n.removeChild(t),e.children[0]?.remove(),e.appendChild(t)},executeRochadeTurn(e,t,n){if(!e.children[0]?.id.includes("king01"+r.pieceColor))return!1;switch(t.id){case"tower01Black":const e=document.getElementById("king01Black");return e.remove(),document.getElementById("field03").appendChild(e),n.removeChild(t),document.getElementById("field04").appendChild(t),!0;case"tower02Black":const i=document.getElementById("king01Black");return i.remove(),document.getElementById("field07").appendChild(i),n.removeChild(t),document.getElementById("field06").appendChild(t),!0;case"tower01White":const o=document.getElementById("king01White");return o.remove(),document.getElementById("field59").appendChild(o),n.removeChild(t),document.getElementById("field60").appendChild(t),!0;case"tower02White":const l=document.getElementById("king01White");return l.remove(),document.getElementById("field63").appendChild(l),n.removeChild(t),document.getElementById("field62").appendChild(t),!0;default:return!1}},executePromotion(e,t){t.id.includes("pawn")&&((e.id.includes("01")||e.id.includes("02")||e.id.includes("03")||e.id.includes("04")||e.id.includes("05")||e.id.includes("06")||e.id.includes("07")||e.id.includes("08"))&&(t.remove(),s.queenWhite.id="queen02White",e.appendChild(s.queenWhite)),(e.id.includes("64")||e.id.includes("63")||e.id.includes("62")||e.id.includes("61")||e.id.includes("60")||e.id.includes("59")||e.id.includes("58")||e.id.includes("57"))&&(t.remove(),s.queenBlack.id="queen02Black",e.appendChild(s.queenBlack)))}},d={handleKeyDownSelectPiece(e){"Enter"===e.key&&a.selectPiece(e)},handleKeyDownExecuteTurn(e){"Enter"===e.key&&s.executeTurn(e)},handleKeyDownDeselect(e){"Enter"===e.key&&c.deselect()}},u={playerColor:"Black",aiAvailableMoves:{pawn01:[["pawn01Black"],[]],pawn02:[["pawn02Black"],[]],pawn03:[["pawn03Black"],[]],pawn04:[["pawn04Black"],[]],pawn05:[["pawn05Black"],[]],pawn06:[["pawn06Black"],[]],pawn07:[["pawn07Black"],[]],pawn08:[["pawn08Black"],[]],tower01:[["tower01Black"],[]],tower02:[["tower02Black"],[]],knight01:[["knight01Black"],[]],knight02:[["knight02Black"],[]],bishop01:[["bishop01Black"],[]],bishop02:[["bishop02Black"],[]],queen01:[["queen01Black"],[]],queen02:[["queen02Black"],[]],king01:[["king01Black"],[]]},executeAiTurn(){this.resetAiAvailableMoves(),this.checkValidMoves();let[e,t]=this.evaluateMoves();this.placeTurn(e,t)},checkValidMoves(){for(let e=0;e<h.board.length;e++)for(let t=0;t<h.board[e].length;t++)h.board[e][t].includes(this.playerColor)&&(r.pieceId=h.board[e][t],a.calculateValidMoves(r.pieceName)&&(this.aiAvailableMoves[r.pieceId.slice(0,-5)][1]=[...r.availableMoves]))},evaluateMoves(){let e=null,t=0;for(const n in this.aiAvailableMoves){const i=this.aiAvailableMoves[n],o=i[0][0],l=i[1];for(const n of l){if(0===n.length)continue;const i=this.evaluateMove(n);i>t&&(t=i,e=[o,n])}}return e},evaluateMove(e){const[t,n]=e,i=h.board[t][n];if(""===i)return this.getFieldValue(t,n);return this.getPieceValue(i)+this.getFieldValue(t,n)},getPieceValue(e){if("king01Black"===e)return 20;return{pawn:10,knight:30,bishop:30,tower:50,queen:100,king:1e3}[e=e.slice(0,-7)]},getFieldValue:(e,t)=>[[1,2,2,2,2,2,2,1],[2,3,4,4,4,3,3,2],[2,4,6,7,7,6,4,2],[2,4,7,8,8,7,4,2],[2,4,7,8,8,7,4,2],[2,4,6,7,7,6,4,2],[2,3,4,4,4,4,3,2],[1,2,2,2,2,2,2,1]][e][t],placeTurn(e,t){r.pieceId=e;const n=this.getFieldId(t),i=document.getElementById(n);i.classList.add("highlightedAi"),setTimeout((function(){s.executeTurn("ai",n),i.classList.remove("highlightedAi")}),600)},getFieldId(e){const[t,n]=e;let i=8*t+n+1;return i<10&&(i="0"+i),`field${i}`},resetAiAvailableMoves(){this.aiAvailableMoves={pawn01:[["pawn01Black"],[]],pawn02:[["pawn02Black"],[]],pawn03:[["pawn03Black"],[]],pawn04:[["pawn04Black"],[]],pawn05:[["pawn05Black"],[]],pawn06:[["pawn06Black"],[]],pawn07:[["pawn07Black"],[]],pawn08:[["pawn08Black"],[]],tower01:[["tower01Black"],[]],tower02:[["tower02Black"],[]],knight01:[["knight01Black"],[]],knight02:[["knight02Black"],[]],bishop01:[["bishop01Black"],[]],bishop02:[["bishop02Black"],[]],queen01:[["queen01Black"],[]],queen02:[["queen02Black"],[]],king01:[["king01Black"],[]]}}},h={round:0,White:{check:!1,player01:"Player01"},Black:{check:!1,player02:"AI"},board:[],getPlayerName(){this.White.player01=document.getElementById("player01").value,this.Black.player02=document.getElementById("player02").value||"AI"},updateBoard(){const e=document.querySelectorAll(".fieldCluster");this.board=[[],[],[],[],[],[],[],[]];let t=0;return e.forEach((e=>{8===this.board[0+t].length&&t++,this.board[0+t].push(e.children[0]?.id??"")})),h.countRounds(),p.checkGameStatus()?p.runGameOver():this.checkAiTurn()?u.executeAiTurn():void c.addEventsToBoard()},countRounds(){this.round+=1},checkAiTurn(){return"AI"===this.Black.player02&&this.round%2==0}},p={originalHtmlBoard:document.getElementById("board").cloneNode(!0),checkGameStatus(){const e=h.round%2==0?"king01Black":"king01White",t=h.round%2==0?h.Black.player02:h.White.player01,n=h.round%2==0?"Black":"White",i=h.round%2==0?"White":"Black";return this.isKingInCheck(e,h.board)?(h[n].check=!0,l.changeMsg(t+" is in Check!")):(h[i].check=!1,h[n].check=!1),!!this.checkMate(n)},isKingInCheck(e,t){const n=e.includes("Black")?"White":"Black",i="Black"===n?"White":"Black";return!!this.detectAllEnemies(e,t,n,i)},detectAllEnemies(e,t,n,i){for(let o=0;o<t.length;o++)for(let l=0;l<t[o].length;l++)if(t[o][l].includes(n)&&this.collectAllMoves(e,t,n,i,o,l))return!0;return!1},collectAllMoves(e,t,n,o,l,c){let a=t[l][c],s=r.getPieceName(a),d=[l,c],u=r.getPiecePosition(e,t);const{possibleMoves:h}=i[s](o,d,t,n,a);return!!this.controlMoveMatch(h,u)},controlMoveMatch(e,t){for(const n of e)if(n[0]===t[0]&&n[1]===t[1])return!0;return!1},checkMate(e){for(let t=0;t<h.board.length;t++)for(let n=0;n<h.board[t].length;n++)if(h.board[t][n].includes(e)&&(r.pieceId=h.board[t][n],a.calculateValidMoves(r.pieceName)))return!1;return!0},runGameOver(){const e=h.round%2==0?h.White.player01:h.Black.player02;l.changeMsg(e+" won the game! Congratulation!"),setTimeout((function(){p.resetGame()}),5050)},resetGame(){h.round=0,document.getElementById("board").remove();const e=p.originalHtmlBoard.cloneNode(!0);e.id="board",document.getElementById("boardInnerBorder").appendChild(e),h.updateBoard()}}}}]);
//# sourceMappingURL=176.js.map